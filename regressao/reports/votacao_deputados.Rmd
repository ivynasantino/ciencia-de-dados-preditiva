---
title: "Usando Regressão Linear para Explicar a votação de Deputados"
author: "Ivyna Santino"
date: "26 de setembro de 2018"
output: html_document
---

```{r setup, include=FALSE, message=FALSE}
library(tidyverse)
library(here)
theme_set(theme_minimal())
library(corrplot)
```

```{r, message=FALSE, warning=FALSE}
eleicao_2006 = read_csv(here("data/eleicoes_2006.csv"))
eleicao_2010 = read_csv(here("data/eleicoes_2010.csv"))
eleicao_2006_2010 = read_csv(here("data/eleicoes_2006_e_2010.csv"))
```

Perguntas:
1.Um modelo de regressão múltipla com todas as variáveis é plausível para explicar a variação em y (número de votos) em 2006? Mesma pergunta para 2010. 
2.Compare as regressões construídas para 2006 e 2010. Quais as diferenças/semelhanças percebidas? Algumas sugestões:
  Analise os plots de resíduos e verifique se há tendências nos erros para cada ano.
  Quais variáveis conseguem explicar melhor o número de votos? Compare essas variáveis entre os modelos. Mesma coisa para as variáveis menos explicativas.
  Compare os valores de R2 e RSE considerando as regressões para cada ano.
  Inclua outros pontos de comparação que você ache interessante.
3.Todas as variáveis são úteis para os modelos de regressão? Há variáveis redudantes? Faça análises para 2006 e 2010 separadamente. 
4.No caso de haver variáveis pouco explicativas e/ou redudantes, construa um novo modelo sem essas variáveis e o compare ao modelo com todas as variáveis (e.g. em termos de R2 e RSE). Faça isso para 2006 e 2010 separadamente. 
5.Construa agora uma regressão considerando os anos 2006 e 2010 em conjunto. Que diferenças/semelhanças você percebe em relação aos modelos individuais por ano? Veja a questão 2 para sugestões que você usar para comparação.

```{r}
names(eleicao_2006)
```



```{r}
# 2006
correlacao <- eleicao_2006 %>% 
  select(qtd_doacoes = quantidade_doacoes,
         qtd_doadores = quantidade_doadores,
         tot_receita = total_receita,
         med_receita = media_receita,
         outros_cand = recursos_de_outros_candidatos.comites,
         pes_fisica = recursos_de_pessoas_fisicas,
         pes_juridica = recursos_de_pessoas_juridicas,
         rec_prop = recursos_proprios,
         rec_partido = recursos_de_partido_politico,
         qtd_desp = quantidade_despesas,
         qtd_fornec = quantidade_fornecedores,
         tot_desp = total_despesa,
         med_desp = media_despesa,
         votos) %>% 
  cor()

library(RColorBrewer)
corrplot(correlacao, type = "upper",
         order = "hclust",
         number.cex = .6,
         addCoef.col = "#FF7F50",
         tl.col = "black", tl.srt = 90,
         col = brewer.pal(n = 8, name = "PuOr"))

```

```{r}
# 2010
correlacao <- eleicao_2010 %>% 
  select(qtd_doacoes = quantidade_doacoes,
         qtd_doadores = quantidade_doadores,
         tot_receita = total_receita,
         med_receita = media_receita,
         outros_cand = recursos_de_outros_candidatos.comites,
         pes_fisica = recursos_de_pessoas_fisicas,
         pes_juridica = recursos_de_pessoas_juridicas,
         rec_prop = recursos_proprios,
         rec_partido = recursos_de_partido_politico,
         qtd_desp = quantidade_despesas,
         qtd_fornec = quantidade_fornecedores,
         tot_desp = total_despesa,
         med_desp = media_despesa,
         votos) %>% 
  cor()

library(RColorBrewer)
corrplot(correlacao, type = "upper",
         order = "hclust",
         number.cex = .6,
         addCoef.col = "#B22222",
         tl.col = "black", tl.srt = 90,
         col = brewer.pal(n = 8, name = "RdYlBu"))
```




